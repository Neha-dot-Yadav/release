workflow:
  as: hypershift-mce-heterogeneous-x86-power
  documentation: |-
    The hypershift-mce-heterogeneous-x86-power workflow executes tests against a new ephemeral Hypershift heterogeneous agent cluster
    created on Power and x86 Nodes to validate the cluster creation reaches completed state.
  steps:
    pre:
      - ref: ingress-aws-nlb-manifest
      - chain: ipi-aws-pre
      - ref: hypershift-mce-install
      - ref: hypershift-mce-conf-os-images
      - ref: hypershift-mce-power-create-hcp
      - chain: hypershift-mce-heterogeneous-power-create-nodepool
      - ref: hypershift-mce-heterogeneous-ibmcloud-x86-create-nodepool
      - chain: hypershift-mce-heterogeneous-ibmcloud-x86-create-workers
    test:
      - chain: hypershift-mce-power-test
      - ref: hypershift-mce-agent-info
    post:
      - ref: hypershift-mce-dump
      - chain: hypershift-mce-heterogeneous-power-destroy
      - ref: hypershift-mce-heterogeneous-ibmcloud-x86-destroy
      - chain: ipi-aws-post
    env:
      HYPERSHIFT_BASE_DOMAIN: "hypershift.cis.ibm.net"
      HYPERSHIFT_NODE_COUNT: 2
      POWERVS_INSTANCE_CRN: "crn:v1:bluemix:public:power-iaas:osa21:a/c265c8cefda241ca9c107adcbbacaa84:ab717f69-9061-4067-8933-5fdcbe444041::"
      POWERVS_IMAGE: "rhcos-none"
      POWERVS_NETWORK: "private-net"
      RESOURCE_GROUP_NAME: "ibm-hypershift-dev"
      VPC_REGION: "jp-osa"
      VPC_ZONE: "jp-osa-1"
      VPC_NAME: "rh-upstream-hypershift-agent-heterogeneous-vpc"
      VPC_SUBNET_ID: "02n7-75996c2e-79d6-4b74-917a-13ab8db29ebe"
      CIS_INSTANCE: "hypershift.cis.ibm.net"
      CIS_DOMAIN_ID: "2efc206d822e60cd3586d1f482ffac97"
      BASTION: "rh-agent-het-ci-bastion.hypershift.cis.ibm.net"
      BASTION_CI_SCRIPTS_DIR: "/root/agent-ci/scripts"
      HYPERSHIFT_INFRA_AVAILABILITY_POLICY: "HighlyAvailable"
      USE_GLB: "no"
